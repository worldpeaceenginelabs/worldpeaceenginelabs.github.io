'use strict';var WPFormsEducation=window.WPFormsEducation||{};WPFormsEducation.core=window.WPFormsEducation.core||(function(document,window,$){var spinner='<i class="wpforms-loading-spinner wpforms-loading-white wpforms-loading-inline"></i>';var app={init:function(){$(app.ready);},ready:function(){app.events();},events:function(){app.dismissEvents();app.openModalButtonClick();app.setDykColspan();},openModalButtonClick:function(){$(document).on('click','.education-modal',function(event){var $this=$(this);event.preventDefault();switch($this.data('action')){case 'activate':app.activateModal($this);break;case 'install':app.installModal($this);break;}});},dismissEvents:function(){$('.wpforms-dismiss-container').on('click','.wpforms-dismiss-button',function(e){var $this=$(this),$cont=$this.closest('.wpforms-dismiss-container'),$out=$cont.find('.wpforms-dismiss-out'),data={action:'wpforms_education_dismiss',nonce:wpforms_education.nonce,section:$this.data('section'),};if($cont.hasClass('wpforms-dismiss-out')){$out=$cont;}
if($out.length>0){$out.addClass('out');setTimeout(function(){$cont.remove();},300);}else{$cont.remove();}
$.post(wpforms_education.ajax_url,data);});},setDykColspan:function(){$('#adv-settings').on('change','input.hide-column-tog',function(event){var $dykCell=$('.wpforms-dyk td'),colCount=$('.wp-list-table thead .manage-column').not('.hidden').length;$dykCell.attr('colspan',colCount);});},getUTMContentValue:function($el){if($el.hasClass('wpforms-add-fields-button')){return $el.data('utm-content')+' Field';}
if($el.hasClass('wpforms-template-select')){return app.slugToUTMcontent($el.data('slug'));}
if($el.hasClass('wpforms-panel-sidebar-section')){return app.slugToUTMcontent($el.data('slug'))+' Addon';}
return $el.data('utm-content')||$el.data('name');},slugToUTMcontent:function(slug){if(!slug){return '';}
return slug.toString().replace(/[^a-z\d ]/gi,' ').replace(/\b[a-z]/g,function(char){return char.toUpperCase();});},getUpgradeURL:function(utmContent,type){var baseURL=wpforms_education.upgrade[type].url;if(utmContent.toLowerCase().indexOf('template')>-1){baseURL=wpforms_education.upgrade[type].url_template;}
var appendChar=/(\?)/.test(baseURL)?'&':'?';return baseURL+appendChar+'utm_content='+encodeURIComponent(utmContent.trim());},activateModal:function($button){var feature=$button.data('name');$.alert({title:false,content:wpforms_education.activate_prompt.replace(/%name%/g,feature),icon:'fa fa-info-circle',type:'blue',buttons:{confirm:{text:wpforms_education.activate_confirm,btnClass:'btn-confirm',keys:['enter'],action:function(){this.$$confirm.prop('disabled',true).html(spinner+wpforms_education.activating);this.$$cancel.prop('disabled',true);app.activateAddon($button,this);return false;},},cancel:{text:wpforms_education.cancel,},},});},activateAddon:function($button,previousModal){var path=$button.data('path'),pluginType=$button.data('type'),nonce=$button.data('nonce'),hideOnSuccess=$button.data('hide-on-success');$.post(wpforms_education.ajax_url,{action:'wpforms_activate_addon',nonce:nonce,plugin:path,type:pluginType,},function(res){previousModal.close();if(res.success){if(hideOnSuccess){$button.hide();}
app.saveModal(pluginType==='plugin'?wpforms_education.plugin_activated:wpforms_education.addon_activated);}else{$.alert({title:false,content:res.data,icon:'fa fa-exclamation-circle',type:'orange',buttons:{confirm:{text:wpforms_education.close,btnClass:'btn-confirm',keys:['enter'],},},});}});},saveModal:function(title){title=title||wpforms_education.addon_activated;$.alert({title:title.replace(/\.$/,''),content:wpforms_education.save_prompt,icon:'fa fa-check-circle',type:'green',buttons:{confirm:{text:wpforms_education.save_confirm,btnClass:'btn-confirm',keys:['enter'],action:function(){if('undefined'===typeof WPFormsBuilder){location.reload();return;}
this.$$confirm.prop('disabled',true).html(spinner+wpforms_education.saving);this.$$cancel.prop('disabled',true);if(WPFormsBuilder.formIsSaved()){location.reload();}
WPFormsBuilder.formSave().done(function(){location.reload();});return false;},},cancel:{text:wpforms_education.close,},},});},installModal:function($button){var feature=$button.data('name'),url=$button.data('url'),licenseType=$button.data('license');if(!url||''===url){app.upgradeModal(feature,'','Empty install URL',licenseType,'');return;}
$.alert({title:false,content:wpforms_education.install_prompt.replace(/%name%/g,feature),icon:'fa fa-info-circle',type:'blue',boxWidth:'425px',buttons:{confirm:{text:wpforms_education.install_confirm,btnClass:'btn-confirm',keys:['enter'],isHidden:!wpforms_education.can_install_addons,action:function(){this.$$confirm.prop('disabled',true).html(spinner+wpforms_education.installing);this.$$cancel.prop('disabled',true);app.installAddon($button,this);return false;},},cancel:{text:wpforms_education.cancel,},},});},installAddon:function($button,previousModal){var url=$button.data('url'),pluginType=$button.data('type'),nonce=$button.data('nonce'),hideOnSuccess=$button.data('hide-on-success');$.post(wpforms_education.ajax_url,{action:'wpforms_install_addon',nonce:nonce,plugin:url,type:pluginType,},function(res){previousModal.close();if(res.success){if(hideOnSuccess){$button.hide();}
app.saveModal(res.data.msg);}else{var message=res.data;if('object'===typeof res.data){message=wpforms_education.addon_error;}
$.alert({title:false,content:message,icon:'fa fa-exclamation-circle',type:'orange',buttons:{confirm:{text:wpforms_education.close,btnClass:'btn-confirm',keys:['enter'],},},});}});},getUpgradeModalWidth:function(isVideoModal){var windowWidth=$(window).width();if(!isVideoModal||windowWidth<=1024){return '550px';}
return windowWidth>1070?'1040px':'994px';},};return app;}(document,window,jQuery));WPFormsEducation.core.init();
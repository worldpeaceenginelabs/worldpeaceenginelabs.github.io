/*!elementor-pro - v3.4.2 - 12-10-2021*/(self["webpackChunkelementor_pro"]=self["webpackChunkelementor_pro"]||[]).push([["load-more"],{"../modules/posts/assets/js/frontend/handlers/load-more.js":/*!*****************************************************************!*\
!*** ../modules/posts/assets/js/frontend/handlers/load-more.js ***!
\*****************************************************************/((__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",({value:true}));exports.default=void 0;class LoadMore extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{postsContainer:'.elementor-posts-container',loadMoreButton:'.elementor-button',loadMoreSpinnerWrapper:'.e-load-more-spinner',loadMoreSpinner:'.e-load-more-spinner i, .e-load-more-spinner svg',loadMoreAnchor:'.e-load-more-anchor'},classes:{loadMoreSpin:'eicon-animation-spin',loadMoreIsLoading:'e-load-more-pagination-loading',loadMorePaginationEnd:'e-load-more-pagination-end',loadMoreNoSpinner:'e-load-more-no-spinner'}};}
getDefaultElements(){const selectors=this.getSettings('selectors');return{postsWidgetWrapper:this.$element[0],postsContainer:this.$element[0].querySelector(selectors.postsContainer),loadMoreButton:this.$element[0].querySelector(selectors.loadMoreButton),loadMoreSpinnerWrapper:this.$element[0].querySelector(selectors.loadMoreSpinnerWrapper),loadMoreSpinner:this.$element[0].querySelector(selectors.loadMoreSpinner),loadMoreAnchor:this.$element[0].querySelector(selectors.loadMoreAnchor)};}
bindEvents(){super.bindEvents();if(!this.elements.loadMoreButton){return;}
this.elements.loadMoreButton.addEventListener('click',event=>{if(this.isLoading){return;}
event.preventDefault();this.handlePostsQuery();});}
onInit(){super.onInit();this.classes=this.getSettings('classes');this.isLoading=false;const paginationType=this.getElementSettings('pagination_type');if('load_more_on_click'!==paginationType&&'load_more_infinite_scroll'!==paginationType){return;}
this.isInfinteScroll='load_more_infinite_scroll'===paginationType;this.isSpinnerAvailable=this.getElementSettings('load_more_spinner').value;if(!this.isSpinnerAvailable){this.elements.postsWidgetWrapper.classList.add(this.classes.loadMoreNoSpinner);}
if(this.isInfinteScroll){this.handleInfiniteScroll();}else if(this.elements.loadMoreSpinnerWrapper){this.elements.loadMoreButton.insertAdjacentElement('beforeEnd',this.elements.loadMoreSpinnerWrapper);}
this.elementId=this.getID();this.postId=elementorFrontendConfig.post.id;this.currentPage=parseInt(this.elements.loadMoreAnchor.getAttribute('data-page'));this.maxPage=parseInt(this.elements.loadMoreAnchor.getAttribute('data-max-page'));if(this.currentPage===this.maxPage){this.handleUiWhenNoPosts();}}
handleInfiniteScroll(){if(this.isEdit){return;}
this.observer=elementorModules.utils.Scroll.scrollObserver({callback:event=>{if(!event.isInViewport||this.isLoading){return;}
this.observer.unobserve(this.elements.loadMoreAnchor);this.handlePostsQuery().then(()=>{if(this.currentPage!==this.maxPage){this.observer.observe(this.elements.loadMoreAnchor);}});}});this.observer.observe(this.elements.loadMoreAnchor);}
handleUiBeforeLoading(){this.isLoading=true;if(this.elements.loadMoreSpinner){this.elements.loadMoreSpinner.classList.add(this.classes.loadMoreSpin);}
this.elements.postsWidgetWrapper.classList.add(this.classes.loadMoreIsLoading);}
handleUiAfterLoading(){this.isLoading=false;if(this.elements.loadMoreSpinner){this.elements.loadMoreSpinner.classList.remove(this.classes.loadMoreSpin);}
if(this.isInfinteScroll&&this.elements.loadMoreSpinnerWrapper){this.elements.loadMoreAnchor.insertAdjacentElement('afterend',this.elements.loadMoreSpinnerWrapper);}
this.elements.postsWidgetWrapper.classList.remove(this.classes.loadMoreIsLoading);}
handleUiWhenNoPosts(){this.elements.postsWidgetWrapper.classList.add(this.classes.loadMorePaginationEnd);}
handleSuccessFetch(result){this.handleUiAfterLoading();const html=document.createElement('div');html.innerHTML=result.content;const posts=html.querySelectorAll('.elementor-posts-container > article');const postsHTML=[...posts].reduce((accumulator,post)=>{return accumulator+post.outerHTML;},'');this.elements.postsContainer.insertAdjacentHTML('beforeend',postsHTML);this.elements.loadMoreAnchor.setAttribute('data-page',this.currentPage);if(this.currentPage===this.maxPage){this.handleUiWhenNoPosts();}}
handlePostsQuery(){this.handleUiBeforeLoading();this.currentPage++;const restUrl=`${ElementorProFrontendConfig.urls.rest}elementor-pro/v1/posts-widget?post_id=${this.postId}&element_id=${this.elementId}&page=${this.currentPage}`;return fetch(restUrl).then(response=>response.json()).then(result=>{this.handleSuccessFetch(result);});}}
exports.default=LoadMore;})}]);